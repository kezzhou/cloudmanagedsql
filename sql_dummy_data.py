#### Imports ####

import dbm
import pandas as pd 
import sqlalchemy
from sqlalchemy import create_engine
from dotenv import load_dotenv
import os



#### Create connection with Azure for MySql Database with Dotenv ####

load_dotenv()

AZURE_MYSQL_HOSTNAME = os.getenv("AZURE_MYSQL_HOSTNAME")
AZURE_MYSQL_USER = os.getenv("AZURE_MYSQL_USERNAME")
AZURE_MYSQL_PASSWORD = os.getenv("AZURE_MYSQL_PASSWORD")
AZURE_MYSQL_DATABASE = os.getenv("AZURE_MYSQL_DATABASE")


connection_string_azure = f'mysql+pymysql://{AZURE_MYSQL_USER}:{AZURE_MYSQL_PASSWORD}@{AZURE_MYSQL_HOSTNAME}:3306/{AZURE_MYSQL_DATABASE}'
db_azure = create_engine(connection_string_azure)



#### Check Tables ####

print(db_azure.table_names()) ## we should see five now



#### Inserting dummy data into newly created tables ####


## Patients

## id int auto_increment, mrn varchar(255), first_name varchar(255), last_name varchar(255), dob varchar(255), gender varchar(255), contact_mobile varchar(255), contact_home varchar(255), zip_code varchar(255) 

insert_dummydata_patients = """
insert into patients values 
(1, '418167217', 'johnny', 'jiang', '10/01/98', 'm', '304-787-7265', '304-787-7265', '25841'), 
(2, '251184421', 'martin', 'noble', '03/20/03', 'm', '301-544-6737', '301-284-9165', '20852'),
(3, '372363834', 'malachy', 'gallagher', '06/04/93', 'm', '785-249-6813', '785-615-0353', '66601'), 
(4, '219361947', 'dakota', 'johnson', '06/09/95', 'f', '309-821-2013', '812-720-3316', '61710'), 
(5, '392920687', 'sarah', 'singh', '10/29/99', 'f', '228-818-9522', '228-875-6598', '39564'), 
(6, '901917262', 'ernest', 'antonino', '02/27/89', 'm', '660-886-3647', '', '65340'), 
(7, '348185917', 'sheldon', 'barrett', '01/30/98', 'm', '786-735-9423', '786-735-9423', '33101'), 
(8, '114828926', 'kevin', 'durant', '07/25/90', 'm', '909-658-2170', '909-658-2170', '90210'), 
(9, '783017954', 'hants', 'williams', '12/20/93', 'm', '330-761-0548', '330-917-4827', '44223'), 
(10, '645253474', 'rajiv', 'lajmi', '01/18/96', 'm', '', '360-257-0902', '98277'), 
(11, '455815706', 'regina', 'chen', '08/07/03', 'f', '516-947-4200', '516-947-4200', '10282'), 
(12, '162375516', 'angel', 'pagan', '02/17/99', 'm', '917-967-4936', '917-967-4936', '11239'), 
(13, '712363603', 'william', 'gates', '03/16/86', 'm', '', '845-789-2462', '12601'), 
(14, '402204622', 'jeffrey', 'bezos', '04/20/84', 'm', '', '214-313-5474', '75051'), 
(15, '118405972', 'peter', 'parker', '06/01/97', 'm', '904-537-9195', '904-537-9195', '32202'), 
(16, '760539145', 'michael', 'mecner', '09/17/83', 'm', '', '860-570-8203', '06119'), 
(17, '544824386', 'melissa', 'mahoney', '03/08/88', 'f', '210-586-4096', '210-586-4096', '78203'), 
(18, '986474475', 'sarah jessica', 'parker', '03/31/97', 'f', '562-485-0098', '562-485-0098', '91768'), 
(19, '195780080', 'charles', 'white', '09/01/88', 'm', '920-959-5448', '262-416-7839', '53205'), 
(20, '802642069', 'elon', 'musk', '06/30/03', 'm', '704-654-4638', '', '28211')
;
"""

## Medications

##    id int auto_increment, mrn varchar(255), brand_name varchar(255), active_ingredients varchar(255), ndc varchar(255)

insert_dummydata_medications = """
insert into medications values 
(1, '418167217', 'johnny', 'jiang', '10/01/98', 'm', '304-787-7265', '304-787-7265', '25841'), 
(2, '251184421', 'martin', 'noble', '03/20/03', 'm', '301-544-6737', '301-284-9165', '20852'),
(3, '372363834', 'malachy', 'gallagher', '06/04/93', 'm', '785-249-6813', '785-615-0353', '66601'), 
(4, '219361947', 'dakota', 'johnson', '06/09/95', 'f', '309-821-2013', '812-720-3316', '61710'), 
(5, '392920687', 'sarah', 'singh', '10/29/99', 'f', '228-818-9522', '228-875-6598', '39564'), 
(6, '901917262', 'ernest', 'antonino', '02/27/89', 'm', '660-886-3647', '', '65340'), 
(7, '348185917', 'sheldon', 'barrett', '01/30/98', 'm', '786-735-9423', '786-735-9423', '33101'), 
(8, '114828926', 'kevin', 'durant', '07/25/90', 'm', '909-658-2170', '909-658-2170', '90210'), 
(9, '783017954', 'hants', 'williams', '12/20/93', 'm', '330-761-0548', '330-917-4827', '44223'), 
(10, '645253474', 'rajiv', 'lajmi', '01/18/96', 'm', '', '360-257-0902', '98277'), 
(11, '455815706', 'regina', 'chen', '08/07/03', 'f', '516-947-4200', '516-947-4200', '10282'), 
(12, '162375516', 'angel', 'pagan', '02/17/99', 'm', '917-967-4936', '917-967-4936', '11239'), 
(13, '712363603', 'william', 'gates', '03/16/86', 'm', '', '845-789-2462', '12601'), 
(14, '402204622', 'jeffrey', 'bezos', '04/20/84', 'm', '', '214-313-5474', '75051'), 
(15, '118405972', 'peter', 'parker', '06/01/97', 'm', '904-537-9195', '904-537-9195', '32202'), 
(16, '760539145', 'michael', 'mecner', '09/17/83', 'm', '', '860-570-8203', '06119'), 
(17, '544824386', 'melissa', 'mahoney', '03/08/88', 'f', '210-586-4096', '210-586-4096', '78203'), 
(18, '986474475', 'sarah jessica', 'parker', '03/31/97', 'f', '562-485-0098', '562-485-0098', '91768'), 
(19, '195780080', 'charles', 'white', '09/01/88', 'm', '920-959-5448', '262-416-7839', '53205'), 
(20, '802642069', 'elon', 'musk', '06/30/03', 'm', '704-654-4638', '', '28211')
;
"""


## Treatments/Procedures

## id int auto_increment, treatments_procedures_name varchar(255), cpt varchar(255)

insert_dummydata_treatments_procedures = """
insert into treatments_procedures values 
(1, '418167217', 'johnny', 'jiang', '10/01/98', 'm', '304-787-7265', '304-787-7265', '25841'), 
(2, '251184421', 'martin', 'noble', '03/20/03', 'm', '301-544-6737', '301-284-9165', '20852'),
(3, '372363834', 'malachy', 'gallagher', '06/04/93', 'm', '785-249-6813', '785-615-0353', '66601'), 
(4, '219361947', 'dakota', 'johnson', '06/09/95', 'f', '309-821-2013', '812-720-3316', '61710'), 
(5, '392920687', 'sarah', 'singh', '10/29/99', 'f', '228-818-9522', '228-875-6598', '39564'), 
(6, '901917262', 'ernest', 'antonino', '02/27/89', 'm', '660-886-3647', '', '65340'), 
(7, '348185917', 'sheldon', 'barrett', '01/30/98', 'm', '786-735-9423', '786-735-9423', '33101'), 
(8, '114828926', 'kevin', 'durant', '07/25/90', 'm', '909-658-2170', '909-658-2170', '90210'), 
(9, '783017954', 'hants', 'williams', '12/20/93', 'm', '330-761-0548', '330-917-4827', '44223'), 
(10, '645253474', 'rajiv', 'lajmi', '01/18/96', 'm', '', '360-257-0902', '98277'), 
(11, '455815706', 'regina', 'chen', '08/07/03', 'f', '516-947-4200', '516-947-4200', '10282'), 
(12, '162375516', 'angel', 'pagan', '02/17/99', 'm', '917-967-4936', '917-967-4936', '11239'), 
(13, '712363603', 'william', 'gates', '03/16/86', 'm', '', '845-789-2462', '12601'), 
(14, '402204622', 'jeffrey', 'bezos', '04/20/84', 'm', '', '214-313-5474', '75051'), 
(15, '118405972', 'peter', 'parker', '06/01/97', 'm', '904-537-9195', '904-537-9195', '32202'), 
(16, '760539145', 'michael', 'mecner', '09/17/83', 'm', '', '860-570-8203', '06119'), 
(17, '544824386', 'melissa', 'mahoney', '03/08/88', 'f', '210-586-4096', '210-586-4096', '78203'), 
(18, '986474475', 'sarah jessica', 'parker', '03/31/97', 'f', '562-485-0098', '562-485-0098', '91768'), 
(19, '195780080', 'charles', 'white', '09/01/88', 'm', '920-959-5448', '262-416-7839', '53205'), 
(20, '802642069', 'elon', 'musk', '06/30/03', 'm', '704-654-4638', '', '28211')
;
"""

## Conditions

## id int auto_increment, mrn varchar(255), icd10 varchar(255), description varchar(255), treatments_procedures_id varchar(255)

insert_dummydata_conditions = """
insert into conditions values 
(1, '418167217', 'g06', 'Intracranial and intraspinal abscess and granuloma', ''),
(1, '418167217', 'g06', 'Intracranial and intraspinal abscess and granuloma', ''),
(1, '418167217', 'g06', 'Intracranial and intraspinal abscess and granuloma', ''),
(1, '418167217', 'g06', 'Intracranial and intraspinal abscess and granuloma', ''),
(2, '251184421', 'martin', 'noble', '03/20/03', 'm', '301-544-6737', '301-284-9165', '20852'),
(3, '372363834', 'malachy', 'gallagher', '06/04/93', 'm', '785-249-6813', '785-615-0353', '66601'), 
(4, '219361947', 'dakota', 'johnson', '06/09/95', 'f', '309-821-2013', '812-720-3316', '61710'), 
(5, '392920687', 'sarah', 'singh', '10/29/99', 'f', '228-818-9522', '228-875-6598', '39564'), 
(6, '901917262', 'ernest', 'antonino', '02/27/89', 'm', '660-886-3647', '', '65340'), 
(7, '348185917', 'sheldon', 'barrett', '01/30/98', 'm', '786-735-9423', '786-735-9423', '33101'), 
(8, '114828926', 'kevin', 'durant', '07/25/90', 'm', '909-658-2170', '909-658-2170', '90210'), 
(9, '783017954', 'hants', 'williams', '12/20/93', 'm', '330-761-0548', '330-917-4827', '44223'), 
(10, '645253474', 'rajiv', 'lajmi', '01/18/96', 'm', '', '360-257-0902', '98277'), 
(11, '455815706', 'regina', 'chen', '08/07/03', 'f', '516-947-4200', '516-947-4200', '10282'), 
(12, '162375516', 'angel', 'pagan', '02/17/99', 'm', '917-967-4936', '917-967-4936', '11239'), 
(13, '712363603', 'william', 'gates', '03/16/86', 'm', '', '845-789-2462', '12601'), 
(14, '402204622', 'jeffrey', 'bezos', '04/20/84', 'm', '', '214-313-5474', '75051'), 
(15, '118405972', 'peter', 'parker', '06/01/97', 'm', '904-537-9195', '904-537-9195', '32202'), 
(16, '760539145', 'michael', 'mecner', '09/17/83', 'm', '', '860-570-8203', '06119'), 
(17, '544824386', 'melissa', 'mahoney', '03/08/88', 'f', '210-586-4096', '210-586-4096', '78203'), 
(18, '986474475', 'sarah jessica', 'parker', '03/31/97', 'f', '562-485-0098', '562-485-0098', '91768'), 
(19, '195780080', 'charles', 'white', '09/01/88', 'm', '920-959-5448', '262-416-7839', '53205'), 
(20, '802642069', 'elon', 'musk', '06/30/03', 'm', '704-654-4638', '', '28211')
;
"""

## Social Determinants

## id int auto_increment, mrn varchar(255), loinc varchar(255), condition_id varchar(255)

insert_dummydata_social_determinants = """
insert into social_determinants values 
(1, '418167217', 'johnny', 'jiang', '10/01/98', 'm', '304-787-7265', '304-787-7265', '25841'), 
(2, '251184421', 'martin', 'noble', '03/20/03', 'm', '301-544-6737', '301-284-9165', '20852'),
(3, '372363834', 'malachy', 'gallagher', '06/04/93', 'm', '785-249-6813', '785-615-0353', '66601'), 
(4, '219361947', 'dakota', 'johnson', '06/09/95', 'f', '309-821-2013', '812-720-3316', '61710'), 
(5, '392920687', 'sarah', 'singh', '10/29/99', 'f', '228-818-9522', '228-875-6598', '39564'), 
(6, '901917262', 'ernest', 'antonino', '02/27/89', 'm', '660-886-3647', '', '65340'), 
(7, '348185917', 'sheldon', 'barrett', '01/30/98', 'm', '786-735-9423', '786-735-9423', '33101'), 
(8, '114828926', 'kevin', 'durant', '07/25/90', 'm', '909-658-2170', '909-658-2170', '90210'), 
(9, '783017954', 'hants', 'williams', '12/20/93', 'm', '330-761-0548', '330-917-4827', '44223'), 
(10, '645253474', 'rajiv', 'lajmi', '01/18/96', 'm', '', '360-257-0902', '98277'), 
(11, '455815706', 'regina', 'chen', '08/07/03', 'f', '516-947-4200', '516-947-4200', '10282'), 
(12, '162375516', 'angel', 'pagan', '02/17/99', 'm', '917-967-4936', '917-967-4936', '11239'), 
(13, '712363603', 'william', 'gates', '03/16/86', 'm', '', '845-789-2462', '12601'), 
(14, '402204622', 'jeffrey', 'bezos', '04/20/84', 'm', '', '214-313-5474', '75051'), 
(15, '118405972', 'peter', 'parker', '06/01/97', 'm', '904-537-9195', '904-537-9195', '32202'), 
(16, '760539145', 'michael', 'mecner', '09/17/83', 'm', '', '860-570-8203', '06119'), 
(17, '544824386', 'melissa', 'mahoney', '03/08/88', 'f', '210-586-4096', '210-586-4096', '78203'), 
(18, '986474475', 'sarah jessica', 'parker', '03/31/97', 'f', '562-485-0098', '562-485-0098', '91768'), 
(19, '195780080', 'charles', 'white', '09/01/88', 'm', '920-959-5448', '262-416-7839', '53205'), 
(20, '802642069', 'elon', 'musk', '06/30/03', 'm', '704-654-4638', '', '28211')
;
"""


db_azure.execute(insert_dummydata_patients)
db_azure.execute(insert_dummydata_medications)
db_azure.execute(insert_dummydata_treatments_procedures)
db_azure.execute(insert_dummydata_conditions)
db_azure.execute(insert_dummydata_social_determinants)